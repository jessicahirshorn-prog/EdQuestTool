<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>The Mysterious Door</title>
<style>
tw-story {
    font-family: Georgia, serif;
    font-size: 18px;
    line-height: 1.6;
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}
tw-passage {
    display: block;
}
tw-link, tw-link:link, tw-link:visited {
    color: #4a90d9;
    text-decoration: none;
    cursor: pointer;
}
tw-link:hover {
    text-decoration: underline;
}
</style>
</head>
<body>
<tw-storydata name="The Mysterious Door" startnode="1" creator="TwineGenerator"
creator-version="1.0.0" ifid="441B1E5D-54AE-4649-A787-0853CCBFAD8D" zoom="1" format="Harlowe" format-version="3.3.9"
options="" tags="" hidden>
<style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css"></style>
<script role="script" id="twine-user-script" type="text/twine-javascript"></script>
<tw-passagedata pid="1" name="Start" tags="" position="100,100" size="100,100">You stand before an old wooden door. The paint is peeling and strange symbols are carved into its surface.

[[Open the door-&gt;Open Door]]
[[Examine the symbols-&gt;Examine Symbols]]
[[Walk away-&gt;Walk Away]]</tw-passagedata>
<tw-passagedata pid="2" name="Open Door" tags="" position="100,250" size="100,100">The door creaks open, revealing a dimly lit corridor. Dust motes dance in the faint light streaming through cracks in the walls.

[[Enter the corridor-&gt;Corridor]]
[[Close the door and leave-&gt;Walk Away]]</tw-passagedata>
<tw-passagedata pid="3" name="Examine Symbols" tags="" position="100,400" size="100,100">The symbols appear to be ancient runes. As you trace them with your finger, they begin to glow with a soft blue light. You feel a strange warmth spreading through your hand.

[[Open the door now-&gt;Open Door]]
[[Step back quickly-&gt;Start]]</tw-passagedata>
<tw-passagedata pid="4" name="Walk Away" tags="" position="100,550" size="100,100">You decide some mysteries are better left unexplored. As you walk away, you can&#x27;t shake the feeling that the door is watching you leave.

**THE END**</tw-passagedata>
<tw-passagedata pid="5" name="Corridor" tags="" position="100,700" size="100,100">You venture deeper into the corridor. The walls seem to pulse with an otherworldly energy. At the end, you see a faint golden light.

You&#x27;ve discovered something ancient and wonderful.

**THE END**</tw-passagedata>
</tw-storydata>
<script>

(function() {
    const storyData = document.querySelector('tw-storydata');
    const passages = {};

    // Parse all passages
    storyData.querySelectorAll('tw-passagedata').forEach(p => {
        passages[p.getAttribute('name')] = {
            pid: p.getAttribute('pid'),
            content: p.textContent
        };
    });

    const startNode = storyData.getAttribute('startnode');
    let startPassage = null;

    for (const [name, data] of Object.entries(passages)) {
        if (data.pid === startNode) {
            startPassage = name;
            break;
        }
    }

    // Create story container
    const storyEl = document.createElement('tw-story');
    document.body.appendChild(storyEl);

    function showPassage(name) {
        const passage = passages[name];
        if (!passage) {
            storyEl.innerHTML = '<p>Error: Passage not found: ' + name + '</p>';
            return;
        }

        // Parse content and convert links
        let content = passage.content;

        // Convert [[text->target]] links
        content = content.replace(/\[\[([^\]]+)->([^\]]+)\]\]/g, (match, text, target) => {
            return `<tw-link data-target="${target}">${text}</tw-link>`;
        });

        // Convert [[target]] links
        content = content.replace(/\[\[([^\]]+)\]\]/g, (match, target) => {
            return `<tw-link data-target="${target}">${target}</tw-link>`;
        });

        // Convert newlines to paragraphs
        content = content.split('\n\n').map(p => '<p>' + p.replace(/\n/g, '<br>') + '</p>').join('');

        const passageEl = document.createElement('tw-passage');
        passageEl.innerHTML = content;

        storyEl.innerHTML = '';
        storyEl.appendChild(passageEl);

        // Add click handlers for links
        passageEl.querySelectorAll('tw-link').forEach(link => {
            link.addEventListener('click', () => {
                showPassage(link.getAttribute('data-target'));
            });
        });
    }

    if (startPassage) {
        showPassage(startPassage);
    }
})();

</script>
</body>
</html>